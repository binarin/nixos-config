# auto-generated via: nix run .#ci-template-generator
jobs:
  propose-inputs-update:
    runs-on: native
    steps:
    - uses: actions/checkout@v4
      with:
        ref: master
    - run: echo nix flake update
    - name: build-valak
      run: "nix build \"$(pwd)#nixosConfigurations.valak.config.system.build.toplevel\"\
        \ \\\n  --keep-going \\\n  -j auto \\\n  -o \"temp-result/valak\"\n"
    - name: build-valak-add-gc-root
      run: "nix-store --add-root \"$HOME/.cache/nixos-config/proposed-update/nixos-configuration/valak\"\
        \ \\\n  -r \"$(readlink -f \"temp-result/valak\")\"\n"
    - name: git-set-user-name
      run: 'git config user.name "Automatic Flake Updater" '
    - name: git-set-user-email
      run: git config user.email "flake-updater@binarin.info"
    - name: git-commit-bump
      run: git commit --allow-empty -am "Bump inputs"
    - name: git-push-proposed
      run: git push --force origin master:flake-bump
'on':
  schedule:
  - cron: 13 10 * * Mon
  workflow_dispatch: {}
