# auto-generated via: nix run .#ci-template-generator
jobs:
  propose-inputs-update:
    runs-on: native
    steps:
    - uses: actions/checkout@v4
      with:
        ref: master
    - name: Update flake inputs
      run: nix flake update
    - name: Set git username for commits
      run: 'git config user.name "Automatic Flake Updater" '
    - name: Set git email for commits
      run: git config user.email "flake-updater@binarin.info"
    - name: Commit updates
      run: git commit --allow-empty -am "Bump inputs"
    - name: Push to flake-bump branch
      run: git push --force origin master:flake-bump
    - name: API auth
      run: set -x; echo "${{ secrets.PR_TOKEN }}" | fj -H forgejo.lynx-lizard.ts.net
        auth add-key nixos-config-bumper
    - name: Maybe create PR
      run: fj -H forgejo.lynx-lizard.ts.net pr create -r binarin/nixos-config --base
        master --head flake-bump --body "Bump flake inputs" "Bump everything" || true
'on':
  schedule:
  - cron: 13 10 * * Mon
  workflow_dispatch: {}
